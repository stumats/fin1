["function _c647eaf1dfa9571f564ec845100d554422752ae7",50,436330,".JsonP",245577,32,"JSONP\",singleton:true,requestCount:0,requests:{},timeout:30000",272158,47,"callbackKey:\"callback\",request:function(m){m=Ext.apply({},m);var i=this,d=Ext.isDefined(m.disableCaching)?m.disableCaching:i.disableCaching,g=m.disableCachingParam||i.disableCachingParam,c=++i.requestCount,k=m.callbackName||\"callback\"+c,h=m.callbackKey||i.callbackKey,l=Ext.isDefined(m.timeout)?m.timeout:i.timeout,e=Ext.apply({},m.params),b=m.url,a=Ext.isSandboxed?Ext.getUniqueGlobalNamespace():\"Ext\",f,j;e[h]=a+\".data.JsonP.\"+k;if(d){e[g]=new Date().getTime()}j=i.createScript(b,e,m);i.requests[c]=f={url:b,params:e,script:j,id:c,scope:m.scope,success:m.success,failure:m.failure,callback:m.callback,callbackKey:h,callbackName:k};if(l>0){f.timeout=setTimeout(Ext.bind(i.handleTimeout,i,[f]),l)}i.setupErrorHandling(f);i[k]=Ext.bind(i.handleResponse,i,[f],true);i.loadScript(f);return f},abort:function(b){var c=this.requests,a;if(b){if(!b.id){b=c[b]}this.handleAbort(b)}else{",107485,36,"this.abort(c[a])}}}},setupErrorHandling:function(a){a.script.onerror=Ext.bind(this.handleError,this,[a])},handleAbort:function(a){a.errorType=\"abort\";this.handleResponse(null,a)},handleError:function(a){a.errorType=\"error\";this.handleResponse(null,a)},cleanupErrorHandling:function(a){a.script.onerror=null},handleTimeout:function(a){a.errorType=\"timeout\";this.handleResponse(null,a)},handleResponse:function(a,b){var c=true;if(b.timeout){clearTimeout(b.timeout)}delete this[b.callbackName];delete this.requests[b.id];this.cleanupErrorHandling(b);Ext.fly(b.script).destroy();if(b.errorType){c=false;Ext.callback(b.failure,b.scope,[b.errorType,b])}else{",276295,37,"}",276333,33,"c,a,b.errorType,b])},createScript:function(c,d,b){var a",48313,33,";a.setAttribute(\"src\",Ext.urlAppend(c,Ext.Object.toQueryString(d)));a.setAttribute(\"async\",true);a.setAttribute(\"type\",\"text/javascript\");return a},loadScript:function(a){Ext.getHead().appendChild(a.script)",384373,36,"Uuid\",{extend:Ext.data.identifier.Simple,alias:\"data.identifier.uuid\",isUnique:true,config:{id:undefined,salt:null,timestamp:null,version:4},applyId:function(a){if(a===undefined){return Ext.data.identifier.Uuid.Global",213084,32,221182,39,"parts=[];a.init()},reconfigure:function(a){this.setConfig(a);this.init()},generate:function(){var c=this,e=c.parts,a=c.getVersion(),b=c.getSalt(),d=c.getTimestamp();e[0]=c.toHex(d.lo,8);e[1]=c.toHex(d.hi&65535,4);e[2]=c.toHex(((d.hi>>>16)&4095)|(a<<12),4);e[3]=c.toHex(128|((c.clockSeq>>>8)&63),2)+c.toHex(c.clockSeq&255,2);e[4]=c.toHex(b.hi,4)+c.toHex(b.lo,8);if(a==4){c.init()}else{++d.lo;if(d.lo>=c.twoPow32){d.lo=0;++d.hi}}return e.join(\"-\").toLowerCase()},init:function(){var b=this,a=b.getSalt(),c=b.getTimestamp();if(b.getVersion()==4){b.clockSeq=b.rand(0,b.twoPow14-1);if(!a){a={};b.setSalt(a)}if(!c){c={};b.setTimestamp(c)}a.lo=b.rand(0,b.twoPow32-1);a.hi=b.rand(0,b.twoPow16-1);c.lo=b.rand(0,b.twoPow32-1);c.hi=b.rand(0,b.twoPow28-1)}else{b.setSalt(b.split(b.getSalt()));b.setTimestamp(b.split(b.getTimestamp()));b.getSalt().hi|=256}},twoPow14:Math.pow(2,14),twoPow16:Math.pow(2,16),twoPow28:Math.pow(2,28),twoPow32:Math.pow(2,32),toHex:function(c,b){var a=c.toString(16);if(a.length>b){a=a.substring(a.length-b)}else{if(a.length<b){a=Ext.String.leftPad(a,b,\"0\")}}return a},rand:function(a,c){var b=Math.random()*(c-a+1);return Math.floor(b)+a},split:function(b){if(typeof(b)==\"number\"){var a=Math.floor(b/this.twoPow32);return{lo:Math.floor(b-a*this.twoPow32),hi:a}}return b}},function(){this.Global=new this({id:\"uuid\"})});Ext.define(\"Ext.data.proxy.JsonP",388750,34,"ternateClassName:\"Ext.data.ScriptTagProxy\",alias:[\"proxy.jsonp\",\"proxy.scripttag\"],config:{defaultWriterType:\"base\",callbackKey:\"callback\",recordParam:\"records\",autoAppendParams:true",389027,39,"c=d.buildRequest(a),e=c.getParams();c.setConfig({callbackKey:d.getCallbackKey(),timeout:d.getTimeout(),scope:d",389182,42,"});if(d.getAutoAppendParams()){c.setParams({})}c.setJsonP(Ext.data.JsonP.request(c.getCurrentConfig()));c.setParams(e);a.setStarted();d.lastRequest=c;return c",389559,69,"h,f,g){delete c.lastRequest;",389635,32,",setException:function(b,a){b.setException(b.getRequest().getJsonP().errorType)},buildUrl:function(f){var e=this,a=e.callParent(arguments),h=Ext.apply({},f.getParams()),d=h.filters,c,b,g;delete h.filters;if(e.getAutoAppendParams()){a=Ext.urlAppend(a,Ext.Object.toQueryString(h))}if(d&&d.length){for(b=0;b<d.length;b++){c=d[b];g=c.getValue();if(g){a=Ext.urlAppend(a,c.getProperty()+\"=\"+g)}}",284298,35,"abort",362418,32,"bort:function(){var a=this.lastRequest;if(a){Ext.data.JsonP.abort(a.getJsonP())}}});Ext.define(\"Ext.data.proxy.WebStorage",359658,34,"ternateClassName:\"Ext.data.WebStorageProxy\",config:{id:undefined,reader:null,writer:null,enablePagingParams:false,defaultDateFormat:\"Y-m-d H:i:s.u",351840,32,"callParent(arguments);this.cache={}},updateModel:function(a){if(!this.getId()){this.setId(a.modelName)}this.callParent(arguments)},create:function(e,h,j){var d=e.getRecords(),c=d.length,a=this.getIds(),b,g,f;e.setStarted();for(f=0;f<c;f++){g=d[f];b=g.getId();this.setRecord(g);a.push(b)}this.setIds(a);e.setCompleted();e.setSuccessful();if(typeof h==\"function\"){h.call(j||this,e)}},read:function(h,o,p){var e=[],a=this.getIds(),l=this.getModel(),q=l.getIdProperty(),g=h.getParams()||{},n=h.getSorters(),d=h.getFilters(),b=h.getStart(),f=h.getLimit(),c=a.length,j,k,m;if(g[q]!==undefined){k=this.getRecord(g[q]);if(k){e.push(k);h.setSuccessful()}}else{for(j=0;j<c;j++){k=this.getRecord(a[j]);if(k){e.push(k)}}m",435102,33,");if(d&&d.length){m.setFilters(d)}if(n&&n.length){m.setSorters(n)}m.addAll(e);if(this.getEnablePagingParams()&&b!==undefined&&f!==undefined){e=m.items.slice(b,b+f)}else{e=m.items.slice()}h.setSuccessful()}h.setCompleted();h.setResultSet(Ext.create(\"Ext.data.ResultSet\",{records:e,total:e.length,loaded:true}));h.setRecords(e);if(typeof o==\"function\"){o.call(p||this,h)}},update:function(e,h,j){var d=e.getRecords(),c=d.length,a=this.getIds(),g,b,f;e.setStarted();for(f=0;f<c;f++){g=d[f];this.setRecord(g);b=g.getId();if(b!==undefined&&Ext.Array.indexOf(a,b)==-1){a.push(b)}}this.setIds(a);e.setCompleted();e.setSuccessful();if(typeof h==\"function\"){h.call(j||this,e)}},destroy:function(b,h,e){var a=b.getRecords(),f=a.length,d=this.getIds(),g=[].concat(d),c;b.setStarted();for(c=0;c<f;c++){Ext.Array.remove(g,a[c].getId());this.removeRecord(a[c],false)}this.setIds(g);",359892,35,"if(typeof h==\"function\"){h.call(e||this,b)}},getRecord:function(c){if(this.cache[c]===undefined){var m=this.getRecordKey(c),n=this.getStorageObject().getItem(m),g={},e=this.getModel(),k=e.getFields().items,d=k.length,h,l,b,j,a,f;if(!n){return undefined}a=Ext.decode(n);for(h=0;h<d;h++){l=k[h];b=l.getName();f=a[b];if(typeof l.getDecode()==\"function\"){g[b]=l.getDecode()(f)}else{if(l.getType().type==\"date\"){g[b]=this.readDate(l,f)}else{g[b]=f}}}j=new e(g,c);this.cache[c]=j}return this.cache[c]},setRecord:function(l,c){if(c){l.setId(c)}else{c=l.getId()}var o=this,a=l.getData(),k={},f=o.getModel(),m=f.getFields().items,d=m.length,j=0,g,p,b,h,q;for(;j<d;j++){p=m[j];b=p.getName();g=a[b];if(p.getPersist()===false){continue}if(typeof p.getEncode()==\"function\"){k[b]=p.getEncode()(g,l)}else{if(p.getType().type==\"date\"&&Ext.isDate(g)){k[b]=this.writeDate(p,g)}else{k[b]=g}}}h=o.getStorageObject();q=o.getRecordKey(c);o.cache[c]=l;h.removeItem(q);try{h.setItem(q,Ext.encode(k))}catch(n",360243,35,")}l.commit()},removeRecord:function(d,c){var b=this,a;if(d.isModel){d=d.getId()}if(c!==false){a=b.getIds();Ext.Array.remove(a,d);b.setIds(a)}delete this.cache[d];b.getStorageObject().removeItem(b.getRecordKey(d))},getRecordKey:function(a){if(a.isModel){a=a.getId()}return Ext.String.format(\"{0}-{1}\",this.getId(),a)},getIds:function(){var b=(this.getStorageObject().getItem(this.getId())||\"\").split(\",\"),c=b.length,a;if(c==1&&b[0]===\"\"){b=[]}return b},setIds:function(a){var c=this.getStorageObject(),d=a.join(\",\"),f=this.getId();c.removeItem(f);if(!Ext.isEmpty(d)){try{c.setItem(f,",350264,44,"b)}}},writeDate:function(c,b){if(Ext.isEmpty(b)",352076,39,"this.getDefaultDateFormat()",352126,119,"readDate:function(c,b){if(Ext.isEmpty(b)",352076,39,"this.getDefaultDateFormat()",352126,34,"new Date(b*1000);case\"time\":return new Date(b);default:return Ext.isDate(b)?b:Ext.Date.parse(b,a)}",251806,33,523932,32,"StorageObject();try{a.setItem(this.getId(),a.getItem(this.getId())||\"\"",350265,43,"b)}},clear:function(){var d=this.getStorageObject(),c=this.getIds(),a=c.length,b;for(b=0;b<a;b++){this.removeRecord(c[b],false)}d.removeItem(this.getId())},getStorageObject",189616,32,"data.proxy.LocalStorage\",{extend:Ext.data.proxy.WebStorage,alias:\"proxy.localstorage\",alternateClassName:\"Ext.data.LocalStorageProxy\",getStorageObject:function(){return window.localStorage",436356,108420,"navigation.Bar\",{extend:Ext.TitleBar",316500,120,"defaultType:\"button\",layout:{type:\"hbox\"},defaultBackButtonText:\"Back\",animation:{duration:300},useTitleForBackButtonText:null,view:null,android2Transforms:false,backButton:{align:\"left\",ui:\"back\",hidden:true}",316726,38,"],animation:false}]",297568,36,"!a.items){a.items=[]}this.backButtonStack=[];this.activeAnimations=[];this.callParent([a])},applyBackButton",522031,38,"Button,this.getBackButton())},updateBackButton:function(a,b){if(b){this.remove(b)}if(a){this.add(a);a.on({scope:this,tap:this.onBackButtonTap})}},onBack",508840,37,"back\",this)},updateView:function(b){var d=this,j=d.getBackButton(),a,c,f,g,e,h;d.getItems();if(b){a=b.getInnerItems();for(c=0;c<a.length;c++){g=a[c];e=(g.getTitle)?g.getTitle():g.config.title;d.backButtonStack.push(e||\"&nbsp;\")}h=d.getTitleText();if(h===undefined){h=\"\"}d.setTitle(h);f=d.getBackButtonText();if(f){j.setText(f);j.show()}}},onViewAdd:function(c,e){var d=this,b=d.backButtonStack,a,f;d.endAnimation();f=(e.getTitle)?e.getTitle():e.config.title;b.push(f||\"&nbsp;\");a=b.length>1;d.doChangeView(c,a,false)},onViewRemove:function(c){var d=this,b=d.backButtonStack,a;d.endAnimation();b.pop();a=b.length>1;d.doChangeView(c,a,true)},doChangeView:function(k,c,g){var r=this,o=r.leftBox,e=o.element,f=r.titleComponent,m=f.element,n=r.getBackButton(),l=r.getTitleText(),h=r.getBackButtonText(),q=r.getAnimation()&&k.getLayout().getAnimation(),p=q&&q.isAnimation&&k.isPainted(),d,i,a,j,b;if(p){i=r.createProxy(o.element);e.setStyle(\"opacity\",\"0\");n.setText(h);n[c?\"show\":\"hide\"]();a=r.createProxy(f.element.getParent());m.setStyle(\"opacity\",\"0\");r.setTitle(l);d=r.measureView(i,a,g);j=d.left;b=d.title;r.isAnimating=true;r.animate(e,j.element);r.animate(m,b.element,function(){m.setLeft(d.titleLeft);r.isAnimating=false;r.refreshTitlePosition()}",449165,32,"2&&!this.getAndroid2Transforms()){i.ghost.destroy();a.ghost.destroy()}else{r.animate(i.ghost,j.ghost);r.animate(a.ghost,b.ghost,function(){i.ghost.destroy();a.ghost.destroy()})}}else{if(c){n.setText(h);n.show()}else{n.hide()}r.setTitle(l)}},measureView:function(e,u,k){var w=this,j=w.element,v=w.leftBox.element,p=w.titleComponent.element,l=Math.min(j.getWidth()/3,200),q=v.getWidth(),c=j.getX(),m=j.getWidth(),n=p.getX(),d=p.getLeft(),s=p.getWidth(),r=e.x,t=e.width,a=e.left,h=Ext.browser.is.AndroidStock2&&!this.getAndroid2Transforms(),i,b,f,x,o,g;g=c-r-t;if(k){i=g;b=Math.min(n-t,l)}else{b=g;i=Math.min(n-c,l)}if(h){f={element:{from:{left:i,opacity:1},to:{left:0,opacity:1}}}}else{f={element:{from:{transform:{translateX:i},opacity:0},to:{transform:{translateX:0},opacity:1}},ghost:{to:{transform:{translateX:b},opacity:0}}}}g=c-n+q;if((a+s)>n){o=c-n-s}if(k){p.setLeft(0);b=c+m-n-s;if(o!==undefined){i=o}else{i=g}}else{i=c+m-n-s;if(o!==undefined){b=o}else{b=g}i=Math.max(d,i)}if(h){x={element:{from:{left:i,opacity:1},to:{left:d,opacity:1}}}}else{x={element:{from:{transform:{translateX:i},opacity:0},to:{transform:{translateX:d},opacity:1}},ghost:{to:{transform:{translateX:b},opacity:0}}}}return{left:f,title:x,titleLeft:d}},animate:function(b,a,e){var c=this,d;b.setLeft(0);a=Ext.apply(a,{element:b,easing:\"ease-in-out\",duration:c.getAnimation().duration||250,preserveEndState:true});d=new Ext.fx.Animation(a);d",260619,33,"e){e.call(c)}},c);Ext.Animator.run(d);c.activeAnimations.push(d)},endAnimation:function(){var a=this.activeAnimations,d,b,c;if(a){c=a.length",534802,32,"Animating){d.stopAnimation()}else{d.destroy()}}this.activeAnimations=[]}",318573,37,"!this.isAnimating){this.callParent()}},getBackButtonText:function(){var b=this.backButtonStack[this.backButtonStack.length-2],a=this.getUseTitleForBackButtonText();if(!a){if(b){b=this.getDefaultBackButtonText()}}return b},getTitleText:function(){return this.backButtonStack[this.backButtonStack.length-1]},beforePop:function(b){b--;for(var a=0;a<b;a++){this.backButtonStack.pop()}},doSetHidden:function(a){if(!a){this.element.setStyle({position:\"relative\",top:\"auto\",left:\"auto\",width:\"auto\"})}else{this.element.setStyle({position:\"absolute\",top:\"-1000px\",left:\"-1000px\",width:this.element.getWidth()+\"px\"})}},createProxy:function(b){var e,a,f,d,c;e=b.dom.cloneNode(true);e.id=b.id+\"-proxy\";b.getParent().dom.appendChild(e);e=Ext.get(e);a=b.getX();f=b.getY();d=b.getLeft();c=b.getWidth();e.setStyle(\"position\",\"absolute\");e.setX(a);e.setY(f);e.setHeight(b.getHeight());e.setWidth(c);return{x:a,y:f,left:d,width:c,ghost:e}}});Ext.define(\"Ext.navigation.",373131,52,"NavigationView\",xtype:\"navigationview",525680,37,"navigationview\",navigationBar:{docked:\"top\"},defaultBackButtonText:\"Back\",useTitleForBackButtonText:false",546642,32,"duration:300,easing:\"ease-out\",type:\"slide\",direction:\"left\"}}",316726,38,"],navigationBar:{splitNavigation:true",507021,39,"b.getNavigationBar();if(a){a.on({back:b.onBackButtonTap,scope:b});b.relayEvents(a,\"rightbuttontap\");b.relayEvents(b,{add:\"push\",remove:\"pop\"})}},applyLayout:function(a){a=a||{};return a},onBackButtonTap:function(){this.pop();this.fireEvent(\"back\",this)},push:function(a){return this.add(a)},pop:function(a){if(this.beforePop(a)){return this.doPop()}},beforePop:function(f){var e=this,g=e.getInnerItems();",250578,37,"var d=g.length-1,a;for(a=d;a>=0;a--){if((Ext.isString(f)&&Ext.ComponentQuery.is(g[a],f))||(Ext.isObject(f)&&f==g[a])){f=d-a;break}}if(!Ext.isNumber(f)){return false}}var c=g.length,b;if(!Ext.isNumber(f)||f<1){f=1}f=Math.min(f,c-1);if(f){e.getNavigationBar().beforePop(f);b=g.splice(-f,f-1);for(a=0;a<b.length;a++){this.remove(b[a])}return true}return false},doPop:function(){var b=this,c=this.getInnerItems();b.remove(c[c.length-1]);if(c.length<3&&this.$backButton){this.$backButton.hide()}if(this.$titleContainer){var a=c[c.length-2];this.$titleContainer.setTitle((a.getTitle)?a.getTitle():a.config.title)}return this.getActiveItem()},getPreviousItem:function(){var a=this.getInnerItems();return a[a.length-2]},updateUseTitleForBackButtonText:function(b){var a=this.getNavigationBar();if(a){a.setUseTitleForBackButtonText(b)}},updateDefaultBackButtonText:function(b){var a=this.getNavigationBar();if(a){a.setDefaultBackButtonText(b)}},applyNavigationBar:function(a){if(!a){a={hidden:true,docked:\"top\"}}if(a.title){delete a.title}a.view=this;a.useTitleForBackButtonText=this.getUseTitleForBackButtonText();if(a.splitNavigation){this.$titleContainer=this.add({docked:\"top\",xtype:\"titlebar\",ui:\"light\",title:this.$currentTitle||\"\"});var b=(a.splitNavigation===true)?{}:a.splitNavigation;this.$backButtonContainer=this.add(Ext.apply({xtype:\"toolbar\",docked:\"bottom\"},b));this.$backButton=this.$backButtonContainer.add({xtype:\"button\",text:\"Back\",hidden:true,ui:\"back\"});this.$backButton.on({scope:this,tap:this.onBackButtonTap});a={hidden:true,docked:\"top\"}}return Ext.factory(a,Ext.navigation.Bar,this.getNavigationBar())},updateNavigationBar:function(a,b){if(b){this.remove(b,true)}if(a){this.add(a)}",259979,36,"b=this,c=b.getInnerItems();b.getItems();if(!b.initialized){d=c.length-1}return this.callParent([d,a])},doResetActiveItem:function(d){var a=this,c=a.getInnerItems(),b=a.getLayout().getAnimation();if(d>0){if(b&&b.isAnimation){b.setReverse(true)}a.setActiveItem(d-1);a.getNavigationBar().onViewRemove(a,c[d],d)}},doRemov",196335,35,".getAnimation();if(a&&a.isAnimation){a.setReverse(false",568063,32,"ItemAdd:function(b,a){if(b&&b.getDocked()&&b.config.title===true){this.$titleContainer=b}this.doItemLayoutAdd(b,a);var c=this.getInitialConfig().navigationBar;if(!this.isItemsInitializing&&b.isInnerItem()){this.setActiveItem(b);if(c){this.getNavigationBar().onViewAdd(this,b,a)}if(this.$backButtonContainer){this.$backButton.show()}}if(b&&b.isInnerItem()){this.updateTitleContainerTitle((b.getTitle)?b.getTitle():b.config.title)}",258873,54,"updateTitleContainerTitle:function(a){if(this.$titleContainer){this.$titleContainer.setTitle(a)}else{this.$currentTitle=a}},reset:function(){return this.pop(this.getInnerItems().length",544755,4208,"ux.OfflineSyncStore\",{extend:Ext.data.Store,config:{trackLocalSync:true,autoServerSync:true,localProxy:null,serverProxy:null},statics:{CREATED:\"created\",UPDATED:\"updated\",REMOVED:\"removed\"}",297568,33,"this.callParent([a])},loadLocal:function(a,b){this._proxy=this.getLocalProxy();this.load(a,b,true)},loadServer:function(a,b){this._proxy=this.getServerProxy();this.on({load:{fn:this.onServerLoad,single:true,scope:this}});this.load(a,b,true)},sync:function(){this._proxy=this.getLocalProxy();var d=this.callParent(arguments);var c=d.added,a=d.updated,b=d.removed;if(this.getTrackLocalSync()){if(c.length>0){this.storeCreated(c)}if(a.length>0){this.storeUpdated(a)}if(b.length>0){this.storeRemoved(b)}if(this.doAutoServerSync()){this.syncServer()}}return d},syncServer:function(){this._proxy=this.getServerProxy();var e=this,b={},f=e.getModifiedRecordsCollection(Ext.ux.OfflineSyncStore.CREATED),d=e.getModifiedRecordsCollection(Ext.ux.OfflineSyncStore.UPDATED),a=e.getRemovedRecordsCollection(Ext.ux.OfflineSyncStore.REMOVED),g=false;if(f.length>0){for(var c=0;c<f.length;c++){f[c].data[this.getModel().getIdProperty()]=f[c].id}",428227,152,428389,46,428442,39,"storeCreated:function(a){this.storeChanged(a,Ext.ux.OfflineSyncStore.CREATED,false)},storeUpdated:function(d){var g=this.getModifiedCollection(Ext.ux.OfflineSyncStore.CREATED),e=[],k=[],a=false,h",345185,32,";for(var c=0;c<d.length;c++){var f=d[c];for(var b=0;b<g.length;b++){if(f.data[h]===g[b][h]){a=true;break}}if(a){e.push(f.data)}else{k.push(f)}}this.storeChanged(this.mergeOrReplaceArrays(g,e),Ext.ux.OfflineSyncStore.CREATED,true);this.storeChanged(k,Ext.ux.OfflineSyncStore.UPDATED,false)},storeRemoved:function(f){var g=this.getModifiedCollection(Ext.ux.OfflineSyncStore.CREATED),e=this.getModifiedCollection(Ext.ux.OfflineSyncStore.UPDATED),l=[],m=false,h",345185,32,";for(var d=0;d<f.length;d++){var c=f[d];for(var b=0;b<g.length;b++){if(c.data[h]===g[b][h]){m=true;g.splice(b,1);break}}for(var a=0;a<e.length;a++){if(c.data[h]===e[a][h]){e.splice(a,1);break}}if(!m){l.push(c)}}this.storeChanged(g,Ext.ux.OfflineSyncStore.CREATED,true);this.storeChanged(e,Ext.ux.OfflineSyncStore.UPDATED,true);this.storeChanged(l,Ext.ux.OfflineSyncStore.REMOVED,false)},storeChanged:function(e,j,a){var f=this.getLocalProxy().getId()+\"-\"+j,g=[];for(var c=0;c<e.length;c++){var b=e[c].isModel?e[c].data:e[c];g.push(b)}var h=localStorage.getItem(f),d=!Ext.isEmpty(h)?Ext.decode(h):[];if(!a){g=this.mergeOrReplaceArrays(d,g)}localStorage.removeItem(f);localStorage.setItem(f,Ext.encode(g)",430337,35,"this.callParent(arguments);if(c&&!this.isLocalMode()){this.clearModifiedCollection(Ext.ux.OfflineSyncStore.CREATED)}",430372,34,"this.callParent(arguments);if(c&&!this.isLocalMode()){this.clearModifiedCollection(Ext.ux.OfflineSyncStore.UPDATED)}",430406,40,"callParent(arguments);if(c&&!this.isLocalMode()){this.clearModifiedCollection(Ext.ux.OfflineSyncStore.REMOVED)}},clearModifiedCollection:function(a){localStorage.removeItem(this.getLocalProxy().getId()+\"-\"+a)},getModifiedCollection:function(b){var c=localStorage.getItem(this.getLocalProxy().getId()+\"-\"+b),a=!Ext.isEmpty(c)?Ext.decode(c):[];return a},getModifiedRecordsCollection:function(d){var e=this.getModifiedCollection(d),b=[];for(var c=0;c<e.length;c++){var a=this.getById(e[c][this.getModel().getIdProperty()]);if(a){b.push(a)}}return b},getRemovedRecordsCollection:function(d){var e=this.getModifiedCollection(d),b=[];for(var c=0;c<e.length;c++){var a=this.getModel().create(e[c]);if(a){b.push(a)}}return b},onServerLoad:function(b,a,c){if(c){this._proxy=this.getLocalProxy();this._proxy.clear();b.each(function(d){d.setDirty(true)});this.disableTrackLocalSync();this.sync();b.each(function(d){d.commit()});this.enableTrackLocalSync()}else{this.loadLocal()}},isLocalMode:function(){return this.getProxy()===this.getLocalProxy()},disableTrackLocalSync:function(){this.setTrackLocalSync(false)},enableTrackLocalSync:function(){this.setTrackLocalSync(true)},hasPendingServerSync:function(){return this.hasPendingCreated()||this.hasPendingUpdated()||this.hasPendingRemoved()},hasPendingCreated:function(){return this.getModifiedCollection(Ext.ux.OfflineSyncStore.CREATED).length>0},hasPendingUpdated:function(){return this.getModifiedCollection(Ext.ux.OfflineSyncStore.UPDATED).length>0},hasPendingRemoved:function(){return this.getModifiedCollection(Ext.ux.OfflineSyncStore.REMOVED).length>0},doAutoServerSync:function(){var a=this.getAutoServerSync();if(Ext.isFunction(a)){a=a.call(this)}return a},applyServerProxy:function(b,a){return this.applyProxy(b,a)},updateServerProxy:function(a){this.updateProxy(a)},applyLocalProxy:function(b,a){return this.applyProxy(b,a)},updateLocalProxy:function(a){this.updateProxy(a)},mergeOrReplaceArrays:function(g,f,b){var e=0,c=g.length,a=f.length,h=false;b=b||this.getModel().getIdProperty();for(;e<c;e++){for(var d=0;d<a;d++){if(g[e][b]===f[d][b]){h=true;break}}if(!h){f.push(g[e])}h=false}return f}",548944,22402,"model.Settings\",{extend:Ext.data.Model,config:{fields:[{name:\"id\",type:\"int\"},{name:\"hideintro\",type:\"boolean\"},{name:\"uselocation\",type:\"boolean\"},{name:\"name\",type:\"string\"},{name:\"email\",type:\"string\"}],validations:[{type:\"email\",field:\"email\",message:\"Email address is invalid.\"}],identifier:{type:\"uuid\"}}});Ext.define(\"maptest1.model.Markers\",{extend:Ext.data.Model,config:{fields:[{name:\"id\",type:\"int\"},{name:\"markerType\",type:\"string\"},{name:\"markerLat\",type:\"float\"},{name:\"markerLng\",type:\"float\"},{name:\"markerTxt\",type:\"string\"},{name:\"markerPic\",type:\"string\"},{name:\"name\",type:\"string\"},{name:\"email\",type:\"string\"},{name:\"date\",type:\"date\"}],validations:[{type:\"presence\",field:\"id\"},{type:\"presence\",field:\"markerLat\",message:\"There is no lat for this marker.\"},{type:\"presence\",field:\"markerLng\",message:\"There is no lng for this marker.\"}],identifier:{type:\"uuid\"}}});Ext.define(\"maptest1.model.serverMarkers\",{extend:Ext.data.Model,config:{fields:[{name:\"id\",type:\"int\"},{name:\"markerType\",type:\"string\"},{name:\"markerLat\",type:\"float\"},{name:\"markerLng\",type:\"float\"},{name:\"markerTxt\",type:\"string\"},{name:\"markerPic\",type:\"string\"},{name:\"name\",type:\"string\"},{name:\"email\",type:\"string\"},{name:\"date\",type:\"date\"}],validations:[{type:\"presence\",field:\"id\"},{type:\"presence\",field:\"markerLat\",message:\"There is no lat for this marker.\"},{type:\"presence\",field:\"markerLng\",message:\"There is no lng for this marker.\"}],identifier:{type:\"uuid\"}",571321,87,"itemId:\"intro\",",571408,76,"road",571502,218,"Click the icon to add notes or change the type. Double-click it to delete it.<br /><br />The Fault List page shows a list of all faults and clicking on each shows a streetview and a static map with marker.<br /",571762,122,573804,111,572039,126,"Add\"},{scrollable:\"vertical\",",572170,57,"50,height:50,margin:\"4px 4px 0 0px\"",572239,52,"5",572292,74,"5",572367,79,"5",572447,78,"5",572526,83,"5",572610,96,"5",572707,210,"false,mapOptions:{zoom:16",572981,213,"MarkerLocalPanel\",{extend:Ext.navigation.View,xtype:\"markerlocalpanel\",config:{items:[{xtype:\"list\",itemId:\"local\",inline:true,store:\"markers\",variableHeights:false,itemHeight:60,itemTpl:[\"*** <strong>{markerType}: </strong> <br />\",\"{markerTxt} <br />\",\"Entered: {date}\",\"<br /><strong>Click for streetview, map etc</strong>\"",574526,33,573194,410,573598,92,"database (limited by cross-site json issue)",573700,344,"Please",571807,77,574128,248,",placeholder:\"required",574375,56,",placeholder:\"required - any valid",574422,172,"main",574607,224,"itemId:\"mapandtool",574828,147,"markerlocalpanel\",iconCls:\"action\",title:\"Fault list\"",574965,228,"}});Ext.define(\"maptest1.controller.settingsControl",326397,37,"refs:{mainView:\"main\",settingsView:\"settingspanel\",introView:\"#intro\",btnSave:\"settingspanel button[action=refresh]\"},control:{btnSave:{tap:\"onSettingsSaveTap\"}}},onSettingsSaveTap:function(c,d,j){var i=c.up(\"settingspanel\");var b=i.getValues();var g=Ext.create(\"maptest1.model.Settings\",{name:b.name,email:b.email,hideintro:b.hideintro,uselocation:b.uselocation});var f=g.validate();var a=\"\";if(!f.isValid()){f.each(function(e){a+=e.getField()+\" : \"+e.getMessage()+\" \"});Ext.Msg.alert(\"ERROR\",a)}else{var h=Ext.getStore(\"settingsSt\");h.removeAll();h.sync();h.add(g);h.sync();if(b.hideintro){this.hideIntro()}else{this.showIntro()}if(b.uselocation){geo.setAutoUpdate(true);geo.updateLocation()}else{geo.setAutoUpdate(false)}Ext.Msg.alert(\"SUCCESS\",\"Form is valid and saved\")}},launch:function(a){checkLocError=0;this.getMainView().setActiveItem(3);loadSettingsData();if(typeof(email)==\"undefined\"){this.getMainView().setActiveItem(\"settingspanel\");return false}if(typeof(hideintro)!==\"undefined\"&&hideintro){this.getMainView().setActiveItem(2);this.getIntroView().hide();this.getMainView().getTabBar().getAt(0).hide()}else{this.getMainView().setActiveItem(1)}if(uselocation){geo.setAutoUpdate(true)}},showIntro:function(){this.getIntroView().show();this.getMainView().getTabBar().getAt(0).show()},hideIntro:function(){this.getIntroView().hide();this.getMainView().getTabBar().getAt(0).hide()}});loadSettingsData=function(){var a=this;Ext.Viewport.setMasked({xtype:\"loadmask\",indicator:true,message:\"Retrieve Settings...\"});Ext.getStore(\"settingsSt\").load({callback:function(c,b,d){if(c.length>0){hideintro=c[0].get(\"hideintro\");uselocation=c[0].get(\"uselocation\");name=c[0].get(\"name\");email=c[0].get(\"email\");if(!hideintro){Ext.ComponentQuery.query(\"settingspanel togglefield[name=hideintro]\")[0].setValue(0)}else{Ext.ComponentQuery.query(\"settingspanel togglefield[name=hideintro]\")[0].setValue(1)}if(!uselocation){Ext.ComponentQuery.query(\"settingspanel togglefield[name=uselocation]\")[0].setValue(0);geo.setAutoUpdate(false)}else{Ext.ComponentQuery.query(\"settingspanel togglefield[name=uselocation]\")[0].setValue(1);geo.setAutoUpdate(true)}Ext.ComponentQuery.query(\"settingspanel textfield[name=name]\")[0].setValue(name);Ext.ComponentQuery.query(\"settingspanel textfield[name=email]\")[0].setValue(email)}Ext.Viewport.unmask()}})};Ext.define(\"maptest1.controller.mapControl",326397,37,"refs:{mainView:\"main\",settingsView:\"settingspanel\",mapView:\"mappanel\",mapBtn1:\"#map-it-btn\",mapBtn2:\"#map-it-btn2\",myMap:'map[id=\"stumap\"]',fld:\"#flood-btn\",treefall:\"#treefall-btn\",pothole:\"#pothole-btn\",lightout:\"#lightout-btn\",lightbroken:\"#lightbroken-btn\",trafficlightbroken:\"#trafficlightbroken-btn\"},control:{mapView:{maprender:\"onRenderMap\"},fld:{tap:\"onFloodTap\"},treefall:{tap:\"onTreefallTap\"},pothole:{tap:\"onPotholeTap\"},lightout:{tap:\"onLightoutTap\"},lightbroken:{tap:\"onLightbrokenTap\"},trafficlightbroken:{tap:\"onTrafficlightbrokenTap\"}}},launch:function(){this.callParent()},init:function(){this.callParent()},onFloodTap:function(){toolbarClick(\"flood\",this.getMyMap())},onTreefallTap:function(){toolbarClick(\"treefall\",this.getMyMap())},onPotholeTap:function(){toolbarClick(\"pothole\",this.getMyMap())},onLightoutTap:function(){toolbarClick(\"lightout\",this.getMyMap())},onLightbrokenTap:function(){toolbarClick(\"lightbroken\",this.getMyMap())},onTrafficlightbrokenTap:function(){toolbarClick(\"trafficlightbroken\",this.getMyMap())},onRenderMap:function(d,c,b){var a=Ext.getStore(\"markers\");a.load();a.each(function(g){var e=new google.maps.LatLng(g.data.markerLat,g.data.markerLng);var f=addMarker(g.data.markerType,c,g.data.markerLat,g.data.markerLng);f.mID=g.data.id;f.details=g.data.markerTxt;mapMarkers.push(f);getInfoWindow()});if(uselocation){geo.setAutoUpdate(true);geo.updateLocation()}}});var mapMarkers=[];getInfoWindow=function(){infowindow=new google.maps.InfoWindow()};var toolbarClick=function(g,a){if(typeof currentLat==\"undefined\"||typeof currentLng==\"undefined\"){if(checkLocError!=1){Ext.Msg.alert(\"Problem\",\"Location cannot be determined now\")}var b=a.getMap().getCenter();var h=b.lat();var i=b.lng();checkLocError=1}else{var h=currentLat;var i=currentLng}var d=addMarker(g,a.getMap(),h,i);settingsName=(typeof name!=\"undefined\")?name:\"-\";settingsEmail=(typeof email!=\"undefined\")?email:\"-\";var e=Ext.create(\"maptest1.model.Markers\",{markerType:g,markerLat:h,markerLng:i,markerTxt:\"some text\",markerPic:\"pic src\",name:settingsName,email:settingsEmail,date:new Date()});var j=e.validate();var c=\"\";if(!j.isValid()){j.each(function(l){c+=l.getField()+\" : \"+l.getMessage()+\" \"});Ext.Msg.alert(\"ERROR\",c)}else{var k=Ext.getStore(\"markers\");var f=k.add(e);d.mID=f[0].getId();d.details=\"\";mapMarkers.push(d);google.maps.event.addListener(d,\"dragend\",function(m){var n=k.findExact(\"id\",d.mID);var l=k.findRecord(\"id\",d.mID);l.set(\"markerLat\",m.latLng.lat().toFixed(7));l.set(\"markerLng\",m.latLng.lng().toFixed(7));k.sync()});k.sync()}};updateMarkerData=function(){var j=Ext.getStore(\"markers\");var f=j.findRecord(\"id\",document.getElementById(\"mID\").value);var d=document.getElementById(\"mID\").value;var a=document.getElementById(\"details\").value;var c=document.getElementById(\"mType\").value;f.set(\"markerTxt\",a);f.set(\"markerType\",c);j.sync();for(var e=0;e<mapMarkers.length;e++){if(mapMarkers[e].mID==d){var h=mapMarkers.indexOf(mapMarkers[e]);var b=mapMarkers[h].mID;break}}var g=\"resources/mapicons/\"+c+\"_icon.png\";mapMarkers[h].setIcon(g);mapMarkers[h].details=a;infowindow.close()};var addMarker=function(f,a,g,i){var e=loSel=tfSel=lbSel=fSel=tlbSel=\"\";switch(f){case\"pothole\":e=\"SELECTED\";break;case\"lightout\":loSel=\"SELECTED\";break;case\"treefall\":tfSel=\"SELECTED\";break;case\"lightbroken\":lbSel=\"SELECTED\";break;case\"flood\":fSel=\"SELECTED\";break;case\"trafficlightbroken\":tlbSel=\"SELECTED\";break}var d={url:\"resources/mapicons/\"+f+\"_icon.png\",size:new google.maps.Size(30,42),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(30,42)};var h=new google.maps.LatLng(g,i);var b=a.getCenter();var c=new google.maps.Marker({position:h,title:f,draggable:true,map:a,icon:d",575268,37,"});if(typeof currentLat==\"undefined\"||typeof currentLng==\"undefined\"){if(checkLocError!=1){Ext.Msg.alert(\"Problem\",\"Location cannot be determined\")}checkLocError=1}else{a.setCenter(new google.maps.LatLng(currentLat,currentLng))}google.maps.event.addListener(c,\"dblclick\",function(){if(confirm(\"Deselect \"+c.title+\" and remove from Map?\")){c.setMap(null);for(var k=0;k<mapMarkers.length;k++){if(mapMarkers[k].getPosition().equals(c.getPosition())){var j=mapMarkers.indexOf(c);mapMarkers.splice(j,1);break}}}});google.maps.event.addListener(c,\"dragend\",function(k){var m=Ext.getStore(\"markers\");var l=m.findExact(\"id\",c.mID);var j=m.findRecord(\"id\",c.mID);j.set(\"markerLat\",k.latLng.lat().toFixed(7));j.set(\"markerLng\",k.latLng.lng().toFixed(7));m.sync()});google.maps.event.addListener(c,\"click\",function(){var k=(typeof c.details!=\"undefined\")?c.details:\"Enter any notes/details\";var j='<table><tr><td>Details:</td> <td><textarea rows=\"3\" cols=\"30\" id=\\'details\\' onfocus=\"this.value=\\'\\';\"/>'+k+\"</textarea> </td> </tr><tr><td></td> <td><input type='hidden' id='mID' value='\"+c.mID+\"' /></td> </tr><tr><td>Change fault:</td> <td><select id='mType'><option value='pothole' \"+e+\">Pothole</option><option value='lightout' \"+loSel+\">Light out</option><option value='treefall' \"+tfSel+\">Tree down</option><option value='lightbroken' \"+lbSel+\">Broken light</option><option value='flood' \"+fSel+\">Flood</option><option value='trafficlightbroken' \"+tlbSel+\">Broken traffic light</option></select> </td></tr><tr><td></td><td><input type='button' value='Update' onclick='updateMarkerData()'/></td></tr></table>\";infowindow.setContent(j);infowindow.open(a,c)});return c};geo=Ext.create(\"Ext.util.Geolocation\",{autoUpdate:false,listeners:{locationupdate:function(d){currentLat=d.getLatitude();currentLng=d.getLongitude();var a=d.getAltitude();var b=d.getSpeed();var c=d.getHeading()},locationerror:function(e,a,b,d,c){if(a){alert(\"Timeout occurred.\")}else{alert(\"Error occurred.\")}}}});Ext.define(\"maptest1.controller.listMarkersControl",326397,37,"refs:{markerdumppanel:\"markerdumppanel\",markerlocalpanel:\"markerlocalpanel\",markerdetailpanel:\"markerdetailpanel\",mapView:\"mappanel\"},control:{markerdumppanel:{itemtap:\"onMarkerItemTap\"},\"markerlocalpanel list\":{itemtap:\"onMarkerLocalItemTap\"}}},slideLeftTransi",546668,36,",onMarkerItemTap:function(b,d,h,a,g,c){this.markerFilter=a.get(\"markerType\");alert(\"dump\");var f=this.getMapView();Ext.Viewport.animateActiveItem(f,this.slideLeftTransition)},onMarkerLocalItemTap:function(c,f,g,d,h,k){if(d){this.details=Ext.create(\"maptest1.view.MarkerDetailPanel\",{title:\"Fault details\"});var j=this.details.child(\"#detailMap\");j.setMapOptions({zoom:14,streetViewControl:true});j.setMapCenter({latitude:d.get(\"markerLat\"),longitude:d.get(\"markerLng\")});var i=new google.maps.LatLng(d.get(\"markerLat\"),d.get(\"markerLng\"));var b=new google.maps.Marker({position:i,title:\"fault\",map:j.getMap()});j.setMapCenter(i);var a=this.details.child(\"#fDetail\").child(\"#info\");a.child(\"#text\").setData(d.data);a.child(\"#extratext\").setData(d.data);a.child(\"#img\").setData(d.data);this.details.child(\"#staticMap\").setData(d.data);this.details.child(\"#streetview\").setData(d.data);this.getMarkerlocalpanel().push(this.details)}",572009,32,"rkerDetailPanel\",{extend:Ext.tab.Panel,xtype:\"markerdetailpanel\",config:{tabbar:{docked:\"top\",ui:\"dark\",layout:{pack:\"center\",type:\"hbox\"}},items:[{xtype:\"container\",itemId:\"fDetail\",iconCls:\"info\",items:[{xtype:\"container\",itemId:\"info\",padding:10,layout:{type:\"vbox\"},items:[{xtype:\"component\",height:100,itemId:\"text\",tpl:[\"<strong>Fault: {markerType}: </strong> <br >\",\"<strong>Notes:</strong> {markerTxt}<br />\"]},{xtype:\"component\",align:\"top\",itemId:\"extratext\",tpl:[\"<strong>Entered by:</strong> {name}: {email}<br />\",\"<strong>Date:</strong> {date}<br />\"]},{xtype:\"component\",itemId:\"img\",tpl:[\"<strong>Fault: {markerType} </strong> <br >\"]}]}]},{xtype:\"component\",itemId:\"streetview\",title:\"Streetview\",iconCls:\"maps\",tpl:Ext.create(\"Ext.XTemplate\",\"{[this.getImage(values)]}\",\"<div>Fault: {markerType}</div>\",\"<div>Latitude: {markerLat}</div>\",\"<div>Longitude: {markerLng}</div>\",{getImage:function(c){if(c.markerLat&&c.markerLat!=\"\"){var b=c.markerLat+\",\"+c.markerLng;var a=\"http://maps.googleapis.com/maps/api/streetview?size=400x400&location=\"+b+\"&fov=50&pitch=-20&sensor=false\";return'<div class=\"photo\"><img src=\"'+a+'\" /></div>'}return'<div class=\"icon-wrapper\">no streetview image available</div>'}})},{xtype:\"map\",gmapType:\"panorama\",itemId:\"detailMap\",title:\"Map\",iconCls:\"maps\"},{xtype:\"component\",itemId:\"staticMap\",title:\"Static map\",iconCls:\"maps\",tpl:Ext.create(\"Ext.XTemplate\",\"{[this.getImage(values)]}\",{getImage:function(b){if(b.markerLat&&b.markerLat!=\"\"){var c=\"&markers=color:blue|label:S|\"+b.markerLat+\",\"+b.markerLng;var a=\"&\"+b.markerLat+\",\"+b.markerLng;return'<div class=\"photo\"><img src=\"http://maps.google.com/maps/api/staticmap?center='+a+c+'&zoom=15&size=384x530&sensor=false\" /></div>'}return'<div class=\"icon-wrapper\">no static map image available</div>'}})}]}});Ext.define(\"maptest1.store.settingsStore\",{extend:Ext.data.Store,config:{model:\"maptest1.model.Settings\",storeId:\"settingsSt\",autoLoad:true,proxy:{type:\"localstorage\",id:\"settingsproxy\"}}});Ext.define(\"maptest1.store.MarkersStore\",{extend:Ext.data.Store,config:{model:\"maptest1.model.Markers\",storeId:\"markers\",autoLoad:true,proxy:{type:\"localstorage\",id:\"markersproxy\"}}});Ext.define(\"maptest1.store.serverMarkers\",{extend:Ext.ux.OfflineSyncStore,config:{model:\"maptest1.model.serverMarkers\",storeId:\"smarkers\",autoSync:true,autoLoad:true,autoServerSync:true,localProxy:{type:\"localstorage\",id:\"offline-sync-store\"},serverProxy:{type:\"ajax\",url:\"http://hybridweb.co.nz/chair/maptest2/json/markers.php?action=readmarkers\",api:{read:\"http://hybridweb.co.nz/chair/maptest2/json/markers.php?action=readmarkers\",create:\"http://hybridweb.co.nz/chair/maptest2/json/markers.php?action=createmarker\"},reader:{type:\"json\",rootProperty:\"markers\"},writer:{allowSingle:false}}},initialize:function(){this.loadLocal(",575361,116,",\"MarkerDetailPanel\",\"MarkerLocalPanel\"],controllers:[\"settingsControl\",\"mapControl\",\"listMarkersControl\"],models:[\"Settings\",\"Markers\",\"serverMarkers\"],stores:[\"settingsStore\",\"MarkersStore\",\"serverMarkers",575476,773]